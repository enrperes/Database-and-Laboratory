las = 1,
ylim      = c(0, max_conti * 1.1)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$n_conti <- as.numeric(table$n_conti)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$n_conti <- as.numeric(table$n_conti)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
table$n_conti <- as.numeric(table$n_conti)
max_conti <- max(table$n_conti)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.2)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.15)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.18)
)
barplot(table$n_conti, names.arg = table$filiale,
main = "Numero conti cointestati con prestito per filiale",
xlab = "Filiale",
ylab = "Numero conti",
col = "skyblue",
border = "white",
las = 1,
ylim      = c(0, max_conti * 1.1)
)
table_ord <- table[order(table$n_conti), ]
max_conti <- max(table$n_conti)
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
# Se filiale è factor o character, trasformalo in numerico
table$filiale_num <- as.integer(as.character(table$filiale))
# Riordina per numero di filiale
table_ord <- table[order(table$filiale_num), ]
# Disegna il barplot con le filiali ordinate 1,2,3…
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,   # conserva la colonna originale per le etichette
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1)
)
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$filiale_num <- as.integer(as.character(table$filiale))
table_ord <- table[order(table$filiale_num), ]
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1)
)
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$filiale_num <- as.integer(as.character(table$filiale))
table_ord <- table[order(table$filiale_num), ]
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1)
)
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$filiale_num <- as.integer(as.character(table$filiale))
table_ord <- table[order(table$filiale_num), ]
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1)
)
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
table_ord <- table[order(table$n_conti), ]
max_conti <- max(table$n_conti)
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
]
]
# Il numero di conti cointestati per filiale che hanno almeno un prestito associato.
dbExecute(con, paste0("
CREATE VIEW conti_cointestati AS
SELECT p1.conto, conto.filiale
FROM possiede AS p1, conto
WHERE p1.conto = conto.iban AND EXISTS (
SELECT *
FROM possiede AS p2
WHERE p1.conto = p2.conto AND p1.cliente < p2.cliente)
;"))
table <- dbGetQuery(con, paste0("
SELECT filiale, COUNT(*) AS n_conti
FROM conti_cointestati, prestito
WHERE conti_cointestati.conto = prestito.conto
AND ammontare > 50.000
GROUP BY filiale
;"))
table$n_conti <- as.numeric(table$n_conti)
max_conti <- max(table$n_conti)
# 1. riordina il data.frame per n_conti
table_ord <- table[order(table$n_conti), ]
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
table_ord <- table[order(table$filiale_num), ]
table$filiale_num <- as.integer(as.character(table$filiale))
table_ord <- table[order(table$filiale_num), ]
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
table$n_conti <- as.numeric(table$n_conti)
max_conti <- max(table$n_conti)
table$filiale_num <- as.integer(as.character(table$filiale))
table_ord <- table[order(table$filiale_num), ]
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti),
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti)*1.2,
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti)*1.2,
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti),
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti),
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti)*1.2,
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti)*1.5,
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
# 2. disegna il barplot con le filiali già ordinate
barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti) * 1.1))
# 3. aggiungi le etichette sopra le barre
text(x = seq_along(table_ord$n_conti),
y = table_ord$n_conti + 0.5,
labels = table_ord$n_conti,
cex    = 0.8,
col    = "black")
table$filiale_num <- as.integer(as.character(table$filiale))
# 1. riordina come fai già
table_ord <- table[order(table$filiale), ]
# 2. disegna il barplot salvando i centri delle barre
bar_centers <- barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti)*1.15)
)
# 3. aggiungi le etichette esattamente sopra ogni barra
text(x      = bar_centers,
y      = table_ord$n_conti + max(table_ord$n_conti)*0.02,  # piccolo offset
labels = table_ord$n_conti,
pos    = 3,      # 3 = sopra il punto (ignora y se usi pos)
cex    = 0.8,
col    = "black"
)
# 3. aggiungi le etichette esattamente sopra ogni barra
text(x      = bar_centers,
y      = table_ord$n_conti + max(table_ord$n_conti)*-0.02,  # piccolo offset
labels = table_ord$n_conti,
pos    = 3,      # 3 = sopra il punto (ignora y se usi pos)
cex    = 0.8,
col    = "black"
)
# 3. aggiungi le etichette esattamente sopra ogni barra
text(x      = bar_centers,
y      = table_ord$n_conti + max(table_ord$n_conti)*-0.1,  # piccolo offset
labels = table_ord$n_conti,
pos    = 3,      # 3 = sopra il punto (ignora y se usi pos)
cex    = 0.8,
col    = "black"
)
# 2. disegna il barplot salvando i centri delle barre
bar_centers <- barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati con prestito per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti)*1.15)
)
# 3. aggiungi le etichette esattamente sopra ogni barra
text(x      = bar_centers,
y      = table_ord$n_conti + max(table_ord$n_conti)*-0.02,  # piccolo offset
labels = table_ord$n_conti,
pos    = 3,      # 3 = sopra il punto (ignora y se usi pos)
cex    = 0.8,
col    = "black"
)
# 2. disegna il barplot salvando i centri delle barre
bar_centers <- barplot(table_ord$n_conti,
names.arg = table_ord$filiale,
main      = "Numero conti cointestati (con prestito) per filiale",
xlab      = "Filiale",
ylab      = "Numero conti",
col       = "skyblue",
border    = "white",
las       = 1,
ylim      = c(0, max(table_ord$n_conti)*1.15)
)
# 3. aggiungi le etichette esattamente sopra ogni barra
text(x      = bar_centers,
y      = table_ord$n_conti + max(table_ord$n_conti)*-0.02,  # piccolo offset
labels = table_ord$n_conti,
pos    = 3,      # 3 = sopra il punto (ignora y se usi pos)
cex    = 0.8,
col    = "black"
)
